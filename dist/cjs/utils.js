Object.defineProperty(exports,"__esModule",{value:!0});var e=require("crypto");const t=/"alg"\s*:\s*"[HERP]S(256|384)"/m,n=/"alg"\s*:\s*"EdDSA"/m,s=/"crv"\s*:\s*"Ed448"/m;exports.ensurePromiseCallback=function(e){if("function"==typeof e)return[e];let t,n;return[function(e,s){return e?n(e):t(s)},new Promise(((e,s)=>{t=e,n=s}))]},exports.getAsyncKey=function(e,t,n){const s=e(t,n);s&&"function"==typeof s.then&&s.then((e=>{process.nextTick((()=>n(null,e)))})).catch(n)},exports.hashToken=function(r){const o=r.split(".",1)[0],c=Buffer.from(o,"base64").toString("utf-8");let u=null;if(c.match(n)&&c.match(s))u=e.createHash("shake256",{outputLength:114});else{const n=c.match(t);u=e.createHash(`sha${n?n[1]:"512"}`)}return u.update(r).digest("hex")};
